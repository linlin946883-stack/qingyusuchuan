# è½»ç¾½é€Ÿä¼ 

ä¸€ä¸ªå¸®åŠ©ç”¨æˆ·ä¼ é€’æƒ…æ„Ÿå’Œä¿¡æ¯çš„å…¨æ ˆ Web åº”ç”¨ç¨‹åºã€‚æä¾›çŸ­ä¿¡ä¼ è¯ã€ç”µè¯å’Œè§£ã€äººå·¥ä¼ è¯ç­‰æœåŠ¡ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

è½»ç¾½é€Ÿä¼ æ˜¯ä¸€ä¸ªæƒ…æ„Ÿä¼ é€’æœåŠ¡å¹³å°ï¼Œå¸®åŠ©ç”¨æˆ·åœ¨éš¾ä»¥ç›´æ¥æ²Ÿé€šçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ç¬¬ä¸‰æ–¹æœåŠ¡ä¼ é€’ä¿¡æ¯å’Œæƒ…æ„Ÿã€‚

### æ ¸å¿ƒåŠŸèƒ½

- ğŸ” **ç”¨æˆ·è®¤è¯**: æ”¯æŒæ‰‹æœºå·ç™»å½•/æ³¨å†Œï¼ŒJWT Token è®¤è¯
- ğŸ“± **ä¼ è¯çŸ­ä¿¡**: ä»£å‘çŸ­ä¿¡æœåŠ¡ï¼Œæ”¯æŒé¢„è®¾æ–‡æ¡ˆ
- ğŸ“ **å’Œè§£ç”µè¯**: ç”µè¯æ²Ÿé€šæœåŠ¡
- ğŸ‘¤ **äººå·¥ä¼ è¯**: çœŸäººä¼ è¯æœåŠ¡
- ğŸ’° **å……å€¼ç³»ç»Ÿ**: ç”¨æˆ·ä½™é¢ç®¡ç†å’Œå……å€¼
- ğŸ›¡ï¸ **æ•æ„Ÿè¯æ£€æµ‹**: UAPI äº‘ç«¯æ•æ„Ÿè¯è¿‡æ»¤
- ğŸ‘¨â€ğŸ’¼ **ç®¡ç†åå°**: è®¢å•ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€æ•°æ®ç»Ÿè®¡

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **Node.js** + **Express.js**: Web æœåŠ¡æ¡†æ¶
- **MySQL**: å…³ç³»å‹æ•°æ®åº“
- **JWT**: ç”¨æˆ·è®¤è¯
- **bcryptjs**: å¯†ç åŠ å¯†
- **UAPI SDK**: æ•æ„Ÿè¯æ£€æµ‹æœåŠ¡

### å‰ç«¯æŠ€æœ¯æ ˆ
- åŸç”Ÿ **HTML/CSS/JavaScript**
- å“åº”å¼è®¾è®¡ï¼Œç§»åŠ¨ç«¯ä¼˜å…ˆ
- Fetch API è¿›è¡Œæ•°æ®äº¤äº’

## ğŸ“ é¡¹ç›®ç»“æ„

```
qingyusuchuan/
â”œâ”€â”€ backend/                 # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ database.js     # æ•°æ®åº“è¿æ¥é…ç½®
â”‚   â”œâ”€â”€ middleware/         # ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ auth.js         # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ security.js     # å®‰å…¨ä¸­é—´ä»¶
â”‚   â”‚   â”œâ”€â”€ errorHandler.js # é”™è¯¯å¤„ç†
â”‚   â”‚   â””â”€â”€ adminLogger.js  # ç®¡ç†å‘˜æ—¥å¿—
â”‚   â”œâ”€â”€ routes/             # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth.js         # è®¤è¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ orders.js       # è®¢å•è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ users.js        # ç”¨æˆ·è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ payment.js      # æ”¯ä»˜è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ presets.js      # é¢„è®¾æ–‡æ¡ˆè·¯ç”±
â”‚   â”‚   â”œâ”€â”€ admin.js        # ç®¡ç†å‘˜è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ config.js       # é…ç½®è·¯ç”±
â”‚   â”‚   â””â”€â”€ sensitiveWord.js # æ•æ„Ÿè¯æ£€æµ‹è·¯ç”±
â”‚   â”œâ”€â”€ services/           # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ index.js        # æœåŠ¡å…¥å£
â”‚   â”‚   â””â”€â”€ sensitiveWordCheck.js # æ•æ„Ÿè¯æ£€æµ‹æœåŠ¡
â”‚   â”œâ”€â”€ scripts/            # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ migrate.js      # åˆå§‹åŒ–æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ add-super-admin.js # æ·»åŠ è¶…çº§ç®¡ç†å‘˜
â”‚   â”‚   â””â”€â”€ ...             # å…¶ä»–è¿ç§»è„šæœ¬
â”‚   â”œâ”€â”€ .env                # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”œâ”€â”€ package.json        # åç«¯ä¾èµ–
â”‚   â”œâ”€â”€ nodemon.json        # Nodemon é…ç½®
â”‚   â””â”€â”€ server.js           # åç«¯å…¥å£æ–‡ä»¶
â”œâ”€â”€ pages/                  # HTML é¡µé¢
â”‚   â”œâ”€â”€ login.html          # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ sms.html            # çŸ­ä¿¡æœåŠ¡é¡µé¢
â”‚   â”œâ”€â”€ call.html           # ç”µè¯æœåŠ¡é¡µé¢
â”‚   â”œâ”€â”€ human.html          # äººå·¥ä¼ è¯é¡µé¢
â”‚   â”œâ”€â”€ my.html             # ä¸ªäººä¸­å¿ƒ
â”‚   â””â”€â”€ dashboard-system.html # ç®¡ç†åå°
â”œâ”€â”€ js/                     # JavaScript æ–‡ä»¶
â”‚   â”œâ”€â”€ common.js           # å…¬å…±å‡½æ•°åº“
â”‚   â”œâ”€â”€ login.js            # ç™»å½•é€»è¾‘
â”‚   â”œâ”€â”€ sms.js              # çŸ­ä¿¡é¡µé¢é€»è¾‘
â”‚   â”œâ”€â”€ call.js             # ç”µè¯é¡µé¢é€»è¾‘
â”‚   â”œâ”€â”€ human.js            # äººå·¥ä¼ è¯é€»è¾‘
â”‚   â”œâ”€â”€ my.js               # ä¸ªäººä¸­å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ admin.js            # ç®¡ç†åå°é€»è¾‘
â”‚   â””â”€â”€ picker.js           # æ—¥æœŸæ—¶é—´é€‰æ‹©å™¨
â”œâ”€â”€ css/                    # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ common.css          # å…¬å…±æ ·å¼
â”‚   â””â”€â”€ ...                 # å„é¡µé¢æ ·å¼
â”œâ”€â”€ icon/                   # å›¾æ ‡èµ„æº
â”œâ”€â”€ font/                   # å­—ä½“èµ„æº
â”œâ”€â”€ index.html              # é¦–é¡µ
â”œâ”€â”€ about.html              # å…³äºé¡µé¢
â”œâ”€â”€ agreement.html          # ç”¨æˆ·åè®®
â”œâ”€â”€ server.js               # å‰ç«¯é™æ€æœåŠ¡å™¨
â””â”€â”€ package.json            # å‰ç«¯ä¾èµ–

```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 14.0
- MySQL >= 5.7
- npm æˆ– yarn

### å®‰è£…æ­¥éª¤

#### 1. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd qingyusuchuan
```

#### 2. å®‰è£…åç«¯ä¾èµ–

```bash
cd backend
npm install
```

#### 3. é…ç½®æ•°æ®åº“

ç¼–è¾‘ `backend/.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=qingyusuchuan

# æœåŠ¡å™¨é…ç½®
PORT=3000
NODE_ENV=development
CORS_ORIGIN=http://localhost:8000

# JWT é…ç½®
JWT_SECRET=your_jwt_secret_key
TOKEN_EXPIRES_IN=30d
```

#### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
npm run migrate
```

#### 5. åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·

```bash
node scripts/add-super-admin.js
```

#### 6. å¯åŠ¨åç«¯æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev

# ç”Ÿäº§æ¨¡å¼
npm start
```

åç«¯æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:3000`

#### 7. å¯åŠ¨å‰ç«¯æœåŠ¡

æ–°å¼€ä¸€ä¸ªç»ˆç«¯çª—å£ï¼š

```bash
cd qingyusuchuan
node server.js
```

å‰ç«¯æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:8000`

### è®¿é—®åº”ç”¨

- å‰ç«¯é¦–é¡µ: http://localhost:8000
- ç®¡ç†åå°: http://localhost:8000/pages/dashboard-system.html
- API åœ°å€: http://localhost:3000/api

## ğŸ“ API æ–‡æ¡£

### è®¤è¯ç›¸å…³

- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `GET /api/auth/verify` - éªŒè¯ Token

### è®¢å•ç›¸å…³

- `POST /api/orders/submit-token` - è·å–æäº¤ä»¤ç‰Œ
- `POST /api/orders/create` - åˆ›å»ºè®¢å•
- `GET /api/orders/user/:userId` - æŸ¥è¯¢ç”¨æˆ·è®¢å•
- `GET /api/orders/:orderId` - æŸ¥è¯¢è®¢å•è¯¦æƒ…

### ç®¡ç†å‘˜ç›¸å…³

- `GET /api/admin/dashboard/stats` - è·å–ç»Ÿè®¡æ•°æ®
- `GET /api/admin/orders` - è®¢å•ç®¡ç†
- `GET /api/admin/users` - ç”¨æˆ·ç®¡ç†
- `PATCH /api/admin/orders/:id/status` - æ›´æ–°è®¢å•çŠ¶æ€

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- JWT Token è®¤è¯
- å¯†ç  bcrypt åŠ å¯†
- SQL æ³¨å…¥é˜²æŠ¤
- XSS é˜²æŠ¤
- CSRF é˜²æŠ¤
- è¯·æ±‚é€Ÿç‡é™åˆ¶
- æ•æ„Ÿè¯è¿‡æ»¤
- ç®¡ç†å‘˜æ“ä½œæ—¥å¿—

## ğŸ› ï¸ æ•°æ®åº“æ¶æ„

### æ ¸å¿ƒè¡¨ç»“æ„

- `users` - ç”¨æˆ·è¡¨
- `orders` - è®¢å•è¡¨
- `payments` - æ”¯ä»˜è®°å½•è¡¨
- `presets` - é¢„è®¾æ–‡æ¡ˆè¡¨
- `admin_logs` - ç®¡ç†å‘˜æ“ä½œæ—¥å¿—è¡¨

## ğŸ“Š ç®¡ç†å‘˜åŠŸèƒ½

- æ•°æ®ç»Ÿè®¡çœ‹æ¿
- è®¢å•ç®¡ç†ï¼ˆæŸ¥çœ‹ã€ä¿®æ”¹çŠ¶æ€ã€å¤‡æ³¨ï¼‰
- ç”¨æˆ·ç®¡ç†ï¼ˆæŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ã€ä½™é¢ç®¡ç†ï¼‰
- é¢„è®¾æ–‡æ¡ˆç®¡ç†
- æ“ä½œæ—¥å¿—æŸ¥è¯¢

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
   - æ£€æŸ¥ `.env` æ–‡ä»¶é…ç½®æ˜¯å¦æ­£ç¡®

2. **åç«¯å¯åŠ¨å¤±è´¥**
   - ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š`npm install`
   - æ£€æŸ¥ç«¯å£ 3000 æ˜¯å¦è¢«å ç”¨

3. **å‰ç«¯æ— æ³•è®¿é—®åç«¯**
   - æ£€æŸ¥ CORS é…ç½®
   - ç¡®è®¤ `js/common.js` ä¸­çš„ `API_BASE_URL` æ˜¯å¦æ­£ç¡®

## ğŸ“„ è®¸å¯è¯

ISC

## ğŸ‘¥ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªå­¦ä¹ /æ¼”ç¤ºé¡¹ç›®ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒå‰è¯·åŠ¡å¿…ï¼š
- ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†é’¥å’Œå¯†ç 
- é…ç½® HTTPS
- é…ç½®ç”Ÿäº§çº§æ•°æ®åº“
- å¯ç”¨æ›´ä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥
- é…ç½®æ—¥å¿—ç®¡ç†å’Œç›‘æ§
